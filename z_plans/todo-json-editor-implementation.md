# 실시간 JSON 편집기 구현 계획

## 📋 개요
현재 읽기 전용인 JSON 미리보기를 실시간으로 편집 가능한 JSON 편집기로 업그레이드하여 사용자가 직접 JSON을 수정하고 설정에 반영할 수 있도록 구현합니다.

## 🎯 핵심 기능 요구사항

### 1. 실시간 JSON 편집
- **텍스트 에디터**: `<textarea>` 또는 전용 코드 에디터 컴포넌트 사용
- **실시간 동기화**: JSON 텍스트 변경 시 설정 상태 즉시 반영
- **양방향 바인딩**: 설정 변경 시 JSON 텍스트도 자동 업데이트

### 2. JSON 유효성 검증
- **실시간 파싱**: 입력 중 JSON 구문 오류 실시간 감지
- **오류 표시**: 구문 오류 시 빨간색 테두리 및 오류 메시지 표시
- **자동 포맷팅**: 유효한 JSON 입력 시 자동 들여쓰기 적용

### 3. 사용자 경험 개선
- **구문 하이라이팅**: JSON 키/값/문자열 등 색상으로 구분
- **자동완성**: 설정 키 입력 시 자동완성 제안
- **되돌리기/다시하기**: Ctrl+Z/Ctrl+Y 단축키 지원

### 4. 안전 장치
- **백업 및 복원**: 편집 전 현재 설정 자동 백업
- **확인 대화상자**: 큰 변경사항 적용 전 사용자 확인
- **기본값 복원**: 오류 시 기본값으로 복원 옵션

## 🔧 구현 세부사항

### A. 상태 관리 추가
```typescript
const [jsonText, setJsonText] = useState<string>('');
const [jsonError, setJsonError] = useState<string | null>(null);
const [isEditing, setIsEditing] = useState(false);
const [settingsBackup, setSettingsBackup] = useState<AppSettings | null>(null);
```

### B. JSON 편집기 컴포넌트
- **CodeMirror 또는 Monaco Editor** 통합 고려
- **기본 textarea 구현**을 먼저 시도하여 복잡성 최소화
- **모바일 최적화**를 위한 반응형 디자인

### C. 실시간 동기화 로직
```typescript
const handleJsonChange = (newJsonText: string) => {
  setJsonText(newJsonText);
  try {
    const parsed = JSON.parse(newJsonText);
    validateAndApplySettings(parsed);
    setJsonError(null);
  } catch (error) {
    setJsonError(error.message);
  }
};
```

### D. 검증 및 적용 시스템
- **스키마 검증**: AppSettings 인터페이스에 맞는지 확인
- **타입 검증**: 각 필드의 타입과 허용값 범위 검사
- **점진적 적용**: 유효한 부분만 먼저 적용

## 🎨 UI/UX 설계

### 1. 편집기 레이아웃
```
┌─────────────────────────────────────────┐
│ [편집 모드] [읽기 모드] [초기화] [저장]  │
├─────────────────────────────────────────┤
│                                         │
│  JSON 편집기                             │
│  ┌─────────────────────────────────────┐ │
│  │ {                                   │ │
│  │   "theme": "light",                 │ │
│  │   "language": "ko",                 │ │
│  │   ...                              │ │
│  │ }                                   │ │
│  └─────────────────────────────────────┘ │
│                                         │
│  [오류: JSON 구문이 잘못되었습니다]     │
│                                         │
├─────────────────────────────────────────┤
│ 실시간 미리보기 | 검증 상태 | 도움말    │
└─────────────────────────────────────────┘
```

### 2. 상태 표시
- **정상**: 초록색 테두리, 체크 아이콘
- **오류**: 빨간색 테두리, 경고 아이콘 + 오류 메시지
- **편집 중**: 노란색 테두리, 연필 아이콘

## 📚 필요한 라이브러리
1. **Monaco Editor** (VS Code 편집기) 또는 **CodeMirror** (가벼운 대안)
2. **JSON Schema 검증** 라이브러리
3. **Debounce** 유틸리티 (과도한 업데이트 방지)

## 🚀 구현 단계

### Phase 1: 기본 편집기
1. textarea 기반 JSON 편집기 구현
2. 실시간 파싱 및 오류 감지
3. 기본 유효성 검증

### Phase 2: UX 개선
1. 구문 하이라이팅 추가
2. 자동 포맷팅 기능
3. 되돌리기/다시하기 구현

### Phase 3: 고급 기능
1. 자동완성 시스템
2. 스키마 기반 검증
3. 가져오기/내보내기 개선

## 🔒 보안 고려사항
- **입력 검증**: 악성 스크립트 방지
- **타입 안전성**: TypeScript 활용한 런타임 검증
- **로컬 저장소**: 민감한 정보 암호화 고려

## 📱 접근성
- **키보드 네비게이션**: Tab, Enter, 화살표 키 지원
- **스크린 리더**: ARIA 레이블 및 설명 추가
- **고대비 모드**: 색상 의존성 최소화

## 📝 구현 우선순위

### 우선순위 1: 핵심 기능
1. **편집 가능한 textarea** 구현
2. **실시간 JSON 파싱** 및 오류 감지
3. **설정 상태 동기화** (JSON ↔ AppSettings)
4. **기본 유효성 검증** (타입 및 값 범위)

### 우선순위 2: 사용성 개선
1. **편집/읽기 모드 토글** 버튼
2. **오류 메시지 표시** UI
3. **자동 포맷팅** (JSON.stringify 활용)
4. **확인 대화상자** (중요 변경사항)

### 우선순위 3: 고급 기능
1. **구문 하이라이팅** (간단한 CSS 클래스 기반)
2. **되돌리기/다시하기** 기능
3. **키보드 단축키** 지원
4. **자동완성** 힌트

이 계획을 통해 사용자가 JSON을 직접 편집하면서도 안전하고 직관적인 설정 관리 경험을 제공할 수 있습니다.